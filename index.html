<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>BoneView – Interactive Model with Toggle Controls</title>
<script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
<style>
  html, body {
    margin: 0; padding: 0; height: 100%;
    background: #000;
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  #container {
    display: flex;
    flex-direction: column;
    width: 100%;
    max-width: 900px;
    flex-grow: 1;
    height: 100vh;
  }

  model-viewer {
    flex-grow: 1;
    width: 100%;
    background-color: #000;
    min-height: 300px;
    aspect-ratio: auto 16 / 9;
  }

  #controls {
    padding: 10px;
    background: none;
    display: flex;
    flex-direction: column;
    gap: 12px;
    align-items: center;
  }

  .buttons {
    display: flex;
    gap: 15px;
    flex-wrap: wrap;
    justify-content: center;
    width: 100%;
  }

  button, select {
    font-size: 1.4rem;
    padding: 14px 20px;
    border-radius: 8px;
    border: none;
    background-color: #222;
    color: white;
    cursor: pointer;
    flex: 1 1 130px;
    max-width: 220px;
    transition: background-color 0.3s ease;
  }

  button:active, select:active {
    background-color: #555;
  }

  #slider {
    width: 90%;
    max-width: 800px;
  }

  #toggleControls {
    font-size: 1.8rem;
    padding: 8px 16px;
    margin: 8px 0 16px 0;
    background: #111;
    color: white;
    border: none;
    border-radius: 10px;
    cursor: pointer;
    user-select: none;
    width: 60px;
    align-self: center;
    transition: background-color 0.3s ease;
  }

  #toggleControls:hover {
    background: #333;
  }

  /* Hidden controls */
  #controls.hidden {
    display: none;
  }

  /* Mobile adjustments */
  @media (max-width: 480px) {
    button, select {
      font-size: 1.8rem;
      padding: 18px 24px;
      max-width: none;
      flex: 1 1 100%;
    }
    #toggleControls {
      width: 80px;
      font-size: 2.2rem;
      padding: 10px 20px;
    }
  }
</style>
</head>
<body>

  <div id="container">
    <model-viewer
      id="viewer"
      src="your_model.glb"
      alt="3D Model"
      ar
      ar-modes="webxr scene-viewer quick-look"
      camera-controls
      autoplay
      auto-rotate
      environment-image="https://modelviewer.dev/shared-assets/environments/neutral.hdr"
    ></model-viewer>

    <button id="toggleControls" aria-label="Toggle controls">⬇️</button>

    <div id="controls">
      <div class="buttons">
        <button id="playPauseBtn">Play</button>
        <button id="arBtn">AR</button>
      </div>
      <select id="animationSelect">
        <option disabled selected>-- Select Animation --</option>
      </select>
      <input type="range" id="slider" min="0" max="1" step="0.001" value="0" />
    </div>
  </div>

<script>
  const viewer = document.getElementById('viewer');
  const playPauseBtn = document.getElementById('playPauseBtn');
  const arBtn = document.getElementById('arBtn');
  const slider = document.getElementById('slider');
  const animationSelect = document.getElementById('animationSelect');
  const toggleControlsBtn = document.getElementById('toggleControls');
  const controls = document.getElementById('controls');

  let userSliding = false;
  let isPlaying = true;

  viewer.addEventListener('load', () => {
    // Populate animation dropdown if available
    const animations = viewer.availableAnimations || [];
    if (animations.length > 0) {
      animationSelect.innerHTML = '<option disabled>-- Select Animation --</option>';
      animations.forEach(name => {
        const option = document.createElement('option');
        option.value = name;
        option.textContent = name;
        animationSelect.appendChild(option);
      });
      viewer.animationName = animations[0];
      animationSelect.value = animations[0];
    }

    // Sync slider with animation progress
    const updateSlider = () => {
      if (!userSliding && viewer.duration > 0) {
        slider.value = viewer.currentTime / viewer.duration;
      }
      requestAnimationFrame(updateSlider);
    };
    updateSlider();
  });

  // Play/pause toggle button
  playPauseBtn.addEventListener('click', () => {
    if (isPlaying) {
      viewer.pause();
      playPauseBtn.textContent = 'Play';
    } else {
      viewer.play();
      playPauseBtn.textContent = 'Pause';
    }
    isPlaying = !isPlaying;
  });

  arBtn.addEventListener('click', () => viewer.activateAR());

  slider.addEventListener('input', () => {
    userSliding = true;
    if (viewer.duration > 0) {
      viewer.currentTime = slider.value * viewer.duration;
    }
  });

  slider.addEventListener('change', () => {
    userSliding = false;
  });

  animationSelect.addEventListener('change', () => {
    viewer.animationName = animationSelect.value;
    viewer.play();
    isPlaying = true;
    playPauseBtn.textContent = 'Pause';
  });

  toggleControlsBtn.addEventListener('click', () => {
    if (controls.classList.contains('hidden')) {
      controls.classList.remove('hidden');
      toggleControlsBtn.textContent = '⬇️';
    } else {
      controls.classList.add('hidden');
      toggleControlsBtn.textContent = '⬆️';
    }
  });
</script>

</body>
</html>
