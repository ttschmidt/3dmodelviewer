<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>BoneView – Interactive Model</title>
  <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
  <style>
    html, body {
      margin: 0; padding: 0; height: 100%; width: 100%; background: #000;
      display: flex; flex-direction: column; align-items: center; justify-content: flex-start;
    }

    model-viewer {
      width: 100%;
      height: 75vh;
      max-height: 800px;
      background-color: #000;
      object-fit: contain;
    }

    #controls {
      width: 100%;
      max-width: 900px;
      padding: 10px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      align-items: center;
    }

    .buttons {
      display: flex;
      gap: 15px;
      flex-wrap: wrap;
      justify-content: center;
    }

    button, select {
      font-size: 1.2rem;
      padding: 10px 16px;
      border-radius: 6px;
      border: none;
      background-color: #222;
      color: white;
      cursor: pointer;
    }

    #modelSelect {
      margin-top: 25px;
      margin-bottom: 25px;
    }

    button:active, select:active {
      background-color: #444;
    }

    #slider, #speedSlider {
      width: 90%;
      max-width: 800px;
    }

    #speedLabel {
      color: white;
      font-size: 1rem;
      margin-top: 8px;
    }

    @media (max-width: 1000px) {
      model-viewer {
        height: 1600px;
      }

      button, select {
        font-size: 2rem;
        padding: 20px 28px;
        min-width: 180px;
      }

      #slider, #speedSlider {
        width: 100%;
      }
    }

    input[type=range] {
      -webkit-appearance: none;
      width: 100%;
      background: transparent;
    }

    input[type=range]::-webkit-slider-runnable-track {
      height: 8px;
      background: #9251ff;
      border-radius: 5px;
    }

    input[type=range]::-moz-range-track {
      height: 8px;
      background: #6c009d;
      border-radius: 5px;
      box-shadow: 0 0 8px #6c009d;
    }

    input[type=range]::-webkit-slider-thumb {
      -webkit-appearance: none;
      height: 20px;
      width: 20px;
      background: white;
      border-radius: 50%;
      margin-top: -6px;
      cursor: pointer;
      box-shadow: 0 0 6px #6c009d;
    }

    input[type=range]::-moz-range-thumb {
      height: 20px;
      width: 20px;
      background: white;
      border-radius: 50%;
      cursor: pointer;
      box-shadow: 0 0 6px #6c009d;
    }

    @media (max-width: 1000px) {
      input[type=range]::-webkit-slider-thumb {
        height: 38px;
        width: 38px;
        margin-top: -10px;
      }

      input[type=range]::-moz-range-thumb {
        height: 48px;
        width: 48px;
      }
    }
  </style>
</head>
<body>

  <select id="modelSelect">
    <option value="african_penguin_spheniscus_demersus_low_poly.glb">Penguin</option>
    <option value="rabbit_rigged.glb">Rabbit</option>
    <option value="elephant.glb">Elephant</option>
  </select>

  <model-viewer
    id="viewer"
    src="african_penguin_spheniscus_demersus_low_poly.glb"
    alt="3D Model"
    ar
    ar-modes="webxr scene-viewer quick-look"
    camera-controls
    autoplay
    auto-rotate
    environment-image="https://modelviewer.dev/shared-assets/environments/neutral.hdr">
  </model-viewer>

  <div id="controls">
    <div class="buttons">
      <button id="playPauseBtn">Pause</button>
    </div>

    <select id="animationSelect">
      <option disabled selected>-- Select Animation --</option>
    </select>

    <input type="range" id="slider" min="0" max="1" step="0.001" value="0" />

    <!-- Playback Speed -->
    <label id="speedLabel" for="speedSlider">Playback Speed: 1.00×</label>
    <input type="range" id="speedSlider" min="0.25" max="3" step="0.01" value="1" />
  </div>

<script>
  const viewer = document.querySelector('#viewer');
  const playPauseBtn = document.getElementById('playPauseBtn');
  const slider = document.getElementById('slider');
  const speedSlider = document.getElementById('speedSlider');
  const speedLabel = document.getElementById('speedLabel');
  const modelSelect = document.getElementById('modelSelect');
  const animationSelect = document.getElementById('animationSelect');

  let userSliding = false;
  let isPlaying = true;
  let speed = parseFloat(speedSlider.value);

  const loadAnimations = () => {
    const animations = viewer.availableAnimations || [];
    animationSelect.innerHTML = '';

    if (animations.length > 0) {
      animations.forEach(name => {
        const option = document.createElement('option');
        option.value = name;
        option.textContent = name;
        animationSelect.appendChild(option);
      });
      viewer.animationName = animations[0];
      animationSelect.value = animations[0];
      viewer.timeScale = speed;
    } else {
      const option = document.createElement('option');
      option.textContent = 'No animations';
      option.disabled = true;
      animationSelect.appendChild(option);
    }
  };

  const syncSlider = () => {
    if (!userSliding && viewer.duration > 0 && isPlaying) {
      slider.value = viewer.currentTime / viewer.duration;
    }
    requestAnimationFrame(syncSlider);
  };

  viewer.addEventListener('load', () => {
    loadAnimations();
    viewer.timeScale = speed;
  });

  playPauseBtn.addEventListener('click', () => {
    isPlaying = !isPlaying;
    if (isPlaying) {
      viewer.play();
      playPauseBtn.textContent = 'Pause';
    } else {
      viewer.pause();
      playPauseBtn.textContent = 'Play';
    }
  });

  slider.addEventListener('input', () => {
    userSliding = true;
    if (viewer.duration > 0) {
      viewer.pause();
      const time = slider.value * viewer.duration;
      viewer.currentTime = time;
    }
  });

  slider.addEventListener('change', () => {
    userSliding = false;
    if (isPlaying) {
      viewer.play();
    }
  });

  speedSlider.addEventListener('input', () => {
    speed = parseFloat(speedSlider.value);
    speedLabel.textContent = `Playback Speed: ${speed.toFixed(2)}×`;
    viewer.timeScale = speed;
  });

  animationSelect.addEventListener('change', () => {
    viewer.animationName = animationSelect.value;
    viewer.timeScale = speed;
    if (isPlaying) viewer.play();
  });

  modelSelect.addEventListener('change', () => {
    viewer.src = modelSelect.value;
    viewer.poster = '';
    viewer.play();
    isPlaying = true;
    playPauseBtn.textContent = 'Pause';
  });

  syncSlider();
</script>


</body>
</html>

